{% extends './template/layout.html' %}
{% block main %}
<div class="layui-card">
  <span class="layui-breadcrumb">
    <a href="/admin">后台管理系统</a>
    <a href="strore">服务网点管理</a>
    <a class="active">网点管理</a>
  </span>
</div>
<a href="store_add" class="layui-btn">添加网点</a>
<table class="layui-table" id="table" lay-filter="operation"></table>
<script type="text/html" id="operation">
  <!-- {{#  if( d.status ){ }} -->
  <a class="layui-btn layui-btn-xs" lay-event="on">开启</a>
  <!-- {{#  }else{ }} -->
  <a class="layui-btn layui-btn-xs layui-btn-warm" lay-event="off">关闭</a>
  <!-- {{#  } }} -->
  <a class="layui-btn layui-btn-xs" lay-event="edit">查看</a>
  <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
  <a class="layui-btn layui-btn-xs layui-btn-danger" lay-event="delete">删除</a>
</script>
<script>
  $(function () {
    var url = '/api/store_list';
    var config = {
      elem: '#table',
      url: url,
      cols: [
        [ //表头
          {
            width: "15%",
            title: '城市',
            align: "center",
            field: 'city',
            templet: function (item) {
              return item.city.name
            }
          }, {
            width: "30%",
            title: '网点名称',
            align: "center",
            field: 'name'
          },
          {
            width: '15%',
            title: '网点电话',
            align: 'center',
            field: 'phone'
          },
          {
            width: '15%',
            title: '状态',
            align: 'center',
            field: 'status',
            templet: function (item) {
              return item.status ? "开启" : "关闭"
            }
          },
          {
            width: '25%',
            title: '操作',
            align: 'center',
            toolbar: '#operation'
          }
        ]
      ],
      page: true
    };
    layui.use(['element', 'table'], function () {
      var element = layui.element;
      var table = layui.table;
      table.render(config)

      table.on('tool(operation)', function(obj){
        var data = obj.data;
        var layEvent = obj.event;
        var _id = data._id.toString();
        if(layEvent == 'edit'){
          location.href = 'store_update?id=' + _id;
        }
      })
    });
  })
</script>
{% endblock %}